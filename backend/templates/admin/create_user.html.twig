{% extends 'base.html.twig' %}

{% block title %}Create user{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('/assets/css/admin_create_user.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
{% endblock %}

{% block body %}
    <section class="create_user_form">
        {#        <img src="{{ asset('/assets/image/logo.png') }}" alt="Admin Logo" class="logo"> #}

        {# Render the form if the user was not created or on first render #}

        {{ form_start(form, {'attr': {'class': 'user-form'}}) }}
        <h2 class="section-title">Create New User</h2>

        {% if error %}
            <div class="create-error">
                {{ error }}
            </div>
        {% elseif userCreated %}
            <div class="create-success">
                <div class="title">User created successfully!</div>
                <div>
                    <span class="bold">Token: </span>
                    <span>{{ newUser.token|slice(0, 20) ~ '...' }}</span>
                    <span class="copy-btn" title="Copy token" onclick="copyToken('{{ newUser.token }}')"><i class="fa-regular fa-copy"></i></span>
                </div>
                <div>
                    <span class="bold">Valid for:</span>
                    <span>{{ newUser.expiration }} seconds</span>
                </div>
            </div>
        {% endif %}

        <div class="form-group">
            {{ form_label(form.username) }}
            {{ form_widget(form.username, {'attr': {'class': 'input'}}) }}
            {{ form_errors(form.username) }}
        </div>

        <div class="form-group">
            {{ form_label(form.email) }}
            {{ form_widget(form.email, {'attr': {'class': 'input'}}) }}
            {{ form_errors(form.email) }}
        </div>

        <button type="submit" class="create-button">Create User</button>
        <a href="{{ path('admin_dashboard') }}" class="back-btn">
            ‚Üê Back to Dashboard
        </a>
        {{ form_end(form) }}


        <script>
            function copyToken(token) {
                navigator.clipboard.writeText(token);
            }
        </script>
    </section>
{% endblock %}
